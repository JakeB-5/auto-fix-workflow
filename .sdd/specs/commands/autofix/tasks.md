---
status: draft
created: 2026-01-30
plan: ./plan.md
total_tasks: 20
completed: 0
---

# /autofix 작업 목록

## 요약
| 우선순위 | 작업 수 | 예상 시간 |
|----------|---------|-----------|
| 🔴 HIGH  | 9       | 22h       |
| 🟡 MEDIUM| 7       | 16h       |
| 🟢 LOW   | 4       | 8h        |
| **합계** | **20**  | **46h**   |

---

### autofix-task-001: GitHub Issues MCP 도구 구현

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 2h
- **의존성:** 없음

#### 설명
GitHub Issues API와 통신하여 이슈를 조회하는 MCP 도구를 구현합니다.

#### 완료 조건
- [ ] `list_issues` MCP 도구 구현
  - 라벨 필터: `auto-fix` 포함, `auto-fix-skip` 제외
  - 상태 필터: `state: open`
  - 페이지네이션 처리 (100개씩)
- [ ] Issue body 파싱 로직
  - 템플릿 섹션 추출 (Context, Problem Description)
  - 컴포넌트 필드 추출
- [ ] Octokit SDK 연동
- [ ] 캐싱 및 재시도 로직
- [ ] 단위 테스트 작성

---

### autofix-task-002: Issue 그룹핑 MCP 도구 구현

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 3h
- **의존성:** autofix-task-001

#### 설명
관련 이슈를 그룹핑하는 MCP 도구를 구현합니다. Component 기반 그룹핑을 지원합니다.

#### 완료 조건
- [ ] `group_issues` MCP 도구 구현
  - Component 기반 그룹핑 알고리즘
  - 동일 컴포넌트 이슈 그룹화
  - 컴포넌트 없는 이슈는 개별 그룹
- [ ] 그룹핑 제안 생성
  - 그룹 ID, 이슈 목록, 예상 브랜치명
  - 파일 충돌 가능성 분석
- [ ] 단위 테스트 작성 (다양한 그룹핑 시나리오)
- [ ] 향후 확장 준비 (file-based, severity-based 전략)

---

### autofix-task-003: Git Worktree 관리 MCP 도구 구현

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 4h
- **의존성:** 없음

#### 설명
Git worktree를 생성하고 관리하는 MCP 도구를 구현합니다. 상태 추적 및 정리 기능을 포함합니다.

#### 완료 조건
- [ ] `manage_worktree` MCP 도구 구현
  - create 액션: 브랜치명 생성, worktree 생성
  - cleanup 액션: worktree 디렉토리 삭제, git worktree remove
  - 브랜치명 규칙: `fix/issue-{numbers}-{component}`
  - 경로 규칙: `../worktrees/fix-issue-{timestamp}`
- [ ] 상태 관리
  - 활성 worktree 목록을 JSON 파일에 저장
  - 비정상 종료 시 복구를 위한 메타데이터
- [ ] 에러 처리
  - 디스크 공간 부족, 권한 부족, 브랜치 충돌
  - 브랜치 충돌 시 번호 증가 (fix-issue-123-1, -2, ...)
- [ ] 단위 테스트 작성

---

### autofix-task-004: 로컬 체크 실행 MCP 도구 구현

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 3h
- **의존성:** 없음

#### 설명
테스트, 타입 체크, 린트 등의 로컬 체크를 실행하는 MCP 도구를 구현합니다.

#### 완료 조건
- [ ] `run_checks` MCP 도구 구현
  - autofix.config.yml에서 체크 명령 로드
  - 기본값: `pnpm test`, `pnpm type-check`, `pnpm lint`
  - 실행 환경 검증 (package.json, pnpm, node_modules)
- [ ] 출력 파싱
  - 성공/실패 판정
  - 실패 시 에러 로그 수집
- [ ] 타임아웃 및 취소
  - 각 체크별 타임아웃 (5분)
  - 사용자 중단 시 프로세스 종료
- [ ] 통합 테스트 작성

---

### autofix-task-005: PR 생성 MCP 도구 구현

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 3h
- **의존성:** autofix-task-001

#### 설명
GitHub PR을 생성하고 이슈와 연결하는 MCP 도구를 구현합니다.

#### 완료 조건
- [ ] `create_pr` MCP 도구 구현
  - title 생성: `fix: {component} issues (#{numbers})`
  - body 템플릿 생성 (이슈 링크, 변경 사항 요약, 테스트 결과, 체크리스트)
  - base: `autofixing` 브랜치, head: 작업 브랜치
- [ ] GitHub API 호출
  - PR 생성
  - 이슈와 PR 연결 ("Fixes #123")
  - 라벨 추가: `auto-fix`, `ready-for-review`
- [ ] 실패 처리
  - 중복 PR 감지, 권한 부족, Merge conflict 감지
- [ ] 단위 테스트 작성

---

### autofix-task-006: Issue 업데이트 MCP 도구 구현

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 2h
- **의존성:** autofix-task-001

#### 설명
GitHub 이슈에 코멘트를 추가하고 라벨을 관리하는 MCP 도구를 구현합니다.

#### 완료 조건
- [ ] `update_issue` MCP 도구 구현
  - 코멘트 추가: "🔄 처리 시작", "✅ PR #{number} 생성", "❌ 자동 수정 실패"
  - 라벨 관리: 추가/제거
- [ ] 멱등성 보장
  - 동일 코멘트 중복 방지
  - 이미 존재하는 라벨 추가 스킵
- [ ] 단위 테스트 작성

---

### autofix-task-007: CLI 파라미터 및 설정 시스템

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 2h
- **의존성:** 없음

#### 설명
CLI 파라미터를 파싱하고 설정 파일을 로드하는 시스템을 구현합니다.

#### 완료 조건
- [ ] 파라미터 파서 구현
  - `--issues`: 쉼표 구분 번호 파싱
  - `--all`, `--dry-run`, `--max-parallel` 지원
  - 검증 로직 (--all과 --dry-run 동시 사용 금지)
- [ ] autofix.config.yml 파서
  - worktree.max_parallel, worktree.base_path
  - github.fix_branch, github.labels
  - checks 배열
- [ ] 스키마 검증 (Zod)
- [ ] 환경 변수 오버라이드
- [ ] 단위 테스트 작성

---

### autofix-task-008: 이슈 조회 및 그룹핑 로직

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 2h
- **의존성:** autofix-task-001, autofix-task-002, autofix-task-007

#### 설명
사용자 입력에 따라 이슈를 조회하고 그룹핑하는 로직을 구현합니다.

#### 완료 조건
- [ ] 모드별 처리 구현
  - `--issues` 지정: 해당 번호만 조회
  - `--all`: 모든 auto-fix 이슈 조회
  - 기본: 조회 후 사용자 선택
- [ ] 이슈 존재 검증
- [ ] 필터링 (auto-fix-skip 라벨 제외)
- [ ] 그룹핑 제안 표시
  - 그룹별 이슈 목록, 예상 브랜치명
  - 예상 PR 개수, 총 처리 시간 추정
- [ ] 확인 프롬프트 (--all 아닌 경우)
- [ ] 통합 테스트 작성

---

### autofix-task-009: 병렬 처리 큐 매니저 구현

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 4h
- **의존성:** autofix-task-003

#### 설명
병렬 처리를 제어하는 큐 매니저를 구현합니다. max_parallel 제한을 준수하고 파일 충돌을 감지합니다.

#### 완료 조건
- [ ] 큐 매니저 구현
  - 대기 큐, 활성 큐, 완료 큐 관리
  - max_parallel 제한 준수
- [ ] 스케줄링 로직
  - 활성 슬롯이 비면 다음 그룹 시작
  - 파일 충돌 감지: 같은 파일 수정 그룹은 순차 처리
  - 독립적 그룹 우선 처리
- [ ] 상태 추적
  - 각 그룹의 현재 단계
  - 진행률 계산 (n/total)
  - 예상 남은 시간
- [ ] 단위 테스트 작성 (다양한 큐 시나리오)

---

### autofix-task-010: Claude AI 분석 및 수정 통합

- **상태:** 대기
- **우선순위:** 🔴 HIGH
- **예상 시간:** 4h
- **의존성:** autofix-task-001

#### 설명
Claude AI를 사용하여 이슈를 분석하고 코드를 수정하는 로직을 구현합니다.

#### 완료 조건
- [ ] Claude AI 분석 프롬프트 작성
  - 이슈 정보 전달 (템플릿 파싱)
  - 코드베이스 컨텍스트 제공
  - 수정 지침 및 제약사항
  - 출력 형식: 파일별 수정 내용
- [ ] Anthropic Claude SDK 연동
- [ ] 분석 및 수정 함수 구현
  - 이슈 번호 배열 받기
  - worktree 경로에서 코드 수정
  - 수정 결과 반환
- [ ] 프롬프트 튜닝 및 샘플 테스트
- [ ] 통합 테스트 작성

---

### autofix-task-011: 단일 그룹 처리 파이프라인

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 3h
- **의존성:** autofix-task-003, autofix-task-004, autofix-task-005, autofix-task-006, autofix-task-010

#### 설명
단일 이슈 그룹을 처리하는 전체 파이프라인을 구현합니다.

#### 완료 조건
- [ ] 처리 파이프라인 구현
  1. Worktree 생성
  2. 이슈 코멘트 (시작)
  3. Claude AI 분석 및 수정
  4. 로컬 테스트 실행
  5a. 성공 시: PR 생성 + 이슈 업데이트
  5b. 실패 시: 재시도 로직 진입
- [ ] 재시도 로직 구현
  - 테스트 실패 로그를 Claude에게 피드백
  - 최대 3회 재시도
  - 매 시도마다 이슈에 진행 상황 코멘트
- [ ] 최종 실패 처리
  - `auto-fix-failed` 라벨 추가
  - 실패 코멘트 작성
- [ ] 통합 테스트 작성

---

### autofix-task-012: 실시간 진행 상황 UI

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 2h
- **의존성:** autofix-task-009

#### 설명
병렬 처리 중인 그룹들의 진행 상황을 실시간으로 표시하는 UI를 구현합니다.

#### 완료 조건
- [ ] 멀티라인 진행 상황 UI 구현
  - 각 활성 그룹의 현재 단계 표시
  - 트리 구조 포맷팅 (├──, └──)
  - 진행률 표시 ([1/3], [2/3])
- [ ] 이벤트 기반 업데이트
  - 단계 변경 시 출력 갱신
  - 성공/실패 시 결과 표시
- [ ] 타임스탬프 포함 (선택적)
- [ ] 수동 테스트 (가독성 확인)

---

### autofix-task-013: 에러 처리 시스템

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 3h
- **의존성:** autofix-task-011

#### 설명
다양한 에러 상황을 처리하는 시스템을 구현합니다.

#### 완료 조건
- [ ] GitHub API 에러 처리
  - 재시도 3회 (지수 백오프)
  - rate limit 시 자동 대기
  - 권한 부족: 명확한 메시지 + 필요 권한 안내
- [ ] Worktree 생성 실패 처리
  - 디스크 공간 경고 + 스킵
  - 권한 부족: 에러 + 종료
  - 브랜치 충돌: 자동 번호 증가
- [ ] 테스트 실패 처리
  - 재시도 로직 진입
  - 최종 실패: auto-fix-failed 라벨 + 코멘트
- [ ] 네트워크 에러 처리
  - 재시도 3회, 타임아웃 조정
- [ ] 통합 테스트 작성 (에러 시뮬레이션)

---

### autofix-task-014: 중단 처리 (Ctrl+C) 및 정리

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 3h
- **의존성:** autofix-task-003, autofix-task-009

#### 설명
사용자가 작업을 중단했을 때 안전하게 정리하는 로직을 구현합니다.

#### 완료 조건
- [ ] 시그널 핸들러 등록
  - SIGINT (Ctrl+C) 감지
  - 새로운 작업 시작 중단
  - 진행 중인 작업 완료 대기
- [ ] 정리 작업
  - 모든 worktree cleanup 호출
  - 처리 중인 이슈에 중단 코멘트
  - auto-fix-processing 라벨 제거
  - 상태 파일 삭제
- [ ] 재시작 지원
  - 중단된 이슈 목록 저장
  - 재시작 시 계속 여부 프롬프트
- [ ] 통합 테스트 작성

---

### autofix-task-015: Worktree 상태 관리 및 자동 정리

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 2h
- **의존성:** autofix-task-003

#### 설명
Worktree 상태를 파일로 관리하고 비정상 종료 시 자동 정리하는 메커니즘을 구현합니다.

#### 완료 조건
- [ ] Worktree 상태 파일 구현
  - 경로: `.autofix-state.json`
  - 내용: 활성 worktree 경로, 이슈 번호, 시작 시간
- [ ] 시작 시 검증
  - 상태 파일 존재 시 경고
  - 정리 여부 프롬프트
  - 자동 정리 실행
- [ ] 강제 정리 명령
  - `/autofix cleanup`: 모든 남은 worktree 정리
- [ ] 단위 테스트 작성

---

### autofix-task-016: 결과 요약 리포트 및 출력

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 2h
- **의존성:** autofix-task-011

#### 설명
처리 완료 후 요약 리포트를 생성하고 구조화된 형식으로 출력합니다.

#### 완료 조건
- [ ] 통계 수집
  - 총 이슈 수, 성공/실패 수, 생성된 PR 수, 총 처리 시간
- [ ] 결과 포맷팅
  - 이모지 및 컬러 사용 (✅, ❌, ⚠️)
  - 구조화된 섹션 (📊, 📤, ❌, 💡)
  - PR 링크 클릭 가능하게 표시
- [ ] Next steps 제안
  - 실패한 이슈: 수동 확인 필요
  - 생성된 PR: 리뷰 요청
  - 성공률 낮으면: 이슈 정보 품질 개선 제안
- [ ] 수동 테스트 (출력 가독성 확인)

---

### autofix-task-017: Dry-run 모드 구현

- **상태:** 대기
- **우선순위:** 🟢 LOW
- **예상 시간:** 2h
- **의존성:** autofix-task-008

#### 설명
실제 변경 없이 처리 계획을 미리 확인할 수 있는 dry-run 모드를 구현합니다.

#### 완료 조건
- [ ] 계획 표시
  - 처리 대상 이슈 및 그룹
  - 생성될 브랜치명, 예상 PR 개수
  - 실행될 체크 목록
- [ ] 실제 작업 스킵 표시
  - "[DRY-RUN] Would create worktree..."
  - "[DRY-RUN] Would create PR..."
- [ ] 예상 시간 계산
  - 그룹당 평균 처리 시간 추정
  - 총 예상 시간 표시
- [ ] 통합 테스트 작성 (실제 변경 없음 확인)

---

### autofix-task-018: 통합 테스트 구축

- **상태:** 대기
- **우선순위:** 🟡 MEDIUM
- **예상 시간:** 4h
- **의존성:** autofix-task-011

#### 설명
Mock 환경을 사용한 전체 플로우 통합 테스트를 구축합니다.

#### 완료 조건
- [ ] Mock 서버 구축
  - Mock GitHub API (nock)
  - Mock Git 저장소 (mock-fs)
  - Mock 테스트 명령 (성공/실패 시뮬레이션)
- [ ] 통합 테스트 시나리오
  1. 정상 플로우: 5개 이슈, 3개 그룹, 모두 성공
  2. 재시도 성공: 첫 시도 실패, 재시도 성공
  3. 부분 실패: 일부 성공, 일부 실패
  4. 중단 및 정리: Ctrl+C 후 재시작
  5. Dry-run: 실제 변경 없이 계획 출력

---

### autofix-task-019: E2E 테스트 및 성능 검증

- **상태:** 대기
- **우선순위:** 🟢 LOW
- **예상 시간:** 3h
- **의존성:** autofix-task-018

#### 설명
실제 GitHub 리포지토리를 사용한 E2E 테스트와 성능 벤치마크를 수행합니다.

#### 완료 조건
- [ ] GitHub Test 리포지토리 준비
- [ ] E2E 테스트 시나리오 실행
  - /autofix --issues 123,124
  - 성공 케이스 검증
- [ ] PR 및 이슈 업데이트 확인
  - PR이 올바른 base로 생성
  - 이슈에 코멘트 추가
  - 라벨 적용
- [ ] 성능 벤치마크
  - 1개 이슈: < 2분
  - 10개 이슈 (병렬 3): < 10분
  - 메모리 사용량: < 500MB

---

### autofix-task-020: 문서화 및 최종 검증

- **상태:** 대기
- **우선순위:** 🟢 LOW
- **예상 시간:** 3h
- **의존성:** autofix-task-016

#### 설명
사용자 문서를 작성하고 전체 시스템을 최종 검증합니다.

#### 완료 조건
- [ ] autofix.config.yml 예제 파일 작성
- [ ] 사용법 문서 작성
  - 기본 사용법
  - 옵션 설명
  - 병렬 처리 설정
  - 예제 시나리오
- [ ] 트러블슈팅 가이드
  - Worktree 정리 방법
  - 일반적인 에러 및 해결 방법
  - 성능 튜닝 가이드
- [ ] 수동 테스트 체크리스트 완료
  - 인터랙티브 모드, 대량 이슈, 병렬 처리
  - Ctrl+C 중단, 재시작, Dry-run
  - PR 포맷, 테스트 재시도, worktree 정리
